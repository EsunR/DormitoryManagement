(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a60059a"],{"09f4":function(t,e,a){"use strict";a.d(e,"a",(function(){return l})),Math.easeInOutQuad=function(t,e,a,n){return t/=n/2,t<1?a/2*t*t+e:(t--,-a/2*(t*(t-2)-1)+e)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function i(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(t,e,a){var l=o(),r=t-l,s=20,u=0;e="undefined"===typeof e?500:e;var d=function t(){u+=s;var o=Math.easeInOutQuad(u,l,r,e);i(o),u<e?n(t):a&&"function"===typeof a&&a()};d()}},"3e0c":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-wrapper",attrs:{id:"visitor-manage"}},[e("h1",{staticClass:"main-title"},[e("span",[t._v("来访人员登记")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.onAddBtnClick}},[t._v("新增")])],1),t._v(" "),e("div",{staticClass:"main-card wrapper"},[e("VisitorTable",{attrs:{tableData:t.tableData,type:"back","table-loading":t.tableLoading}}),t._v(" "),e("Pagination",{attrs:{total:t.count,page:t.current,hidden:0===t.tableData.length},on:{pagination:t.handlePagination}})],1),t._v(" "),e("VisitorCreateModal",{attrs:{visible:t.createModalVisible},on:{"update:visible":function(e){t.createModalVisible=e},"create-success":t.onCreateSuccess}})],1)},i=[],o=(a("7f7f"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"visitor-table"},[t.title?e("div",{staticClass:"table-title"},[t._v("\n    来访人员记录\n  ")]):t._e(),t._v(" "),e("div",{staticClass:"table-wrapper"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData}},[e("el-table-column",{attrs:{label:"姓名",prop:"name"}}),t._v(" "),e("el-table-column",{attrs:{label:"电话",prop:"phone"}}),t._v(" "),e("el-table-column",{attrs:{label:"身份证",prop:"idNumber"}}),t._v(" "),e("el-table-column",{attrs:{label:"性别"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s("0"===e.row.sex?"男":"女")+"\n        ")]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"到访宿舍楼"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.building.name)+"\n        ")]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"到访日日",prop:"createdAt"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.$moment(e.row.createdAt).format("YYYY-MM-DD HH:mm"))+"\n        ")]}}])})],1)],1)])}),l=[],r={name:"VisitorTable",data:function(){return{}},props:{tableData:{type:Array,default:function(){return[]}},tableLoading:{type:Boolean,default:!1},title:{type:String},icon:{type:String}}},s=r,u=(a("dd1a"),a("2877")),d=Object(u["a"])(s,o,l,!1,null,"359d7c0a",null),c=d.exports,f=a("333d"),b=function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"visitor-create-modal",attrs:{title:"新增访客记录",visible:t.visible,width:"600px"},on:{"update:visible":function(e){return t.$emit("update:visible",e)}}},[e("el-form",{ref:"form",attrs:{model:t.formData,"label-position":"top"}},[e("el-form-item",{attrs:{label:"访问宿舍楼",prop:"buildingId",required:""}},[e("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.formData.buildingId,callback:function(e){t.$set(t.formData,"buildingId",e)},expression:"formData.buildingId"}},t._l(t.buildingsData,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),t._v(" "),e("el-form-item",{attrs:{prop:"name",label:"姓名",required:""}},[e("el-input",{model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),t._v(" "),e("el-form-item",{attrs:{prop:"phone",label:"手机号",required:""}},[e("el-input",{model:{value:t.formData.phone,callback:function(e){t.$set(t.formData,"phone",e)},expression:"formData.phone"}})],1),t._v(" "),e("el-form-item",{attrs:{prop:"idNumber",label:"身份证号",required:""}},[e("el-input",{model:{value:t.formData.idNumber,callback:function(e){t.$set(t.formData,"idNumber",e)},expression:"formData.idNumber"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"性别",prop:"sex",required:""}},[e("el-radio-group",{model:{value:t.formData.sex,callback:function(e){t.$set(t.formData,"sex",e)},expression:"formData.sex"}},[e("el-radio",{attrs:{label:0}},[t._v("男")]),t._v(" "),e("el-radio",{attrs:{label:1}},[t._v("女")])],1)],1)],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){return t.$emit("update:visible",!1)}}},[t._v("\n      取消\n    ")]),t._v(" "),e("el-button",{attrs:{loading:t.updateLoading,type:"primary"},on:{click:t.onConfirmClick}},[t._v("\n      确定\n    ")])],1)],1)},m=[],p=(a("c5f6"),a("db72")),v=a("70ad"),h=a("b775");function g(t){var e=t.step,a=void 0===e?void 0:e,n=t.current,i=void 0===n?void 0:n;return Object(h["a"])({url:"/visitor/list",method:"get",params:{step:a,current:i}})}function _(t){var e=t.name,a=void 0===e?null:e,n=t.phone,i=void 0===n?null:n,o=t.idNumber,l=void 0===o?null:o,r=t.sex,s=void 0===r?null:r,u=t.buildingId,d=void 0===u?null:u;return Object(h["a"])({url:"/visitor/create",method:"post",data:{name:a,phone:i,idNumber:l,sex:s,buildingId:d}})}var D={props:{visible:{type:Boolean,default:!1}},data:function(){return{formData:{name:"",phone:"",idNumber:"",sex:0,buildingId:void 0},updateLoading:!1,buildingsData:[]}},methods:{onConfirmClick:function(){var t=this;this.$refs.form.validate((function(e){e&&(t.updateLoading=!0,_(Object(p["a"])(Object(p["a"])({},t.formData),{},{buildingId:Number(t.formData.buildingId)})).then((function(){t.$message.success("新增成功"),t.$emit("update:visible",!1),t.$emit("create-success")})).finally((function(){t.updateLoading=!1})))}))},fetchBuildingsData:function(){var t=this;Object(v["i"])().then((function(e){t.buildingsData=e.data.buildings}))}},mounted:function(){this.fetchBuildingsData()}},w=D,y=Object(u["a"])(w,b,m,!1,null,"339bf83f",null),k=y.exports,x={components:{VisitorTable:c,Pagination:f["a"],VisitorCreateModal:k},data:function(){return{current:1,count:0,step:10,tableData:[],tableLoading:!1,createModalVisible:!1}},methods:{fetchTableData:function(){var t=this,e={current:this.current,step:this.step};this.tableLoading=!0,g(e).then((function(e){t.tableData=e.data.rows,t.count=e.data.count})).finally((function(){t.tableLoading=!1}))},handlePagination:function(t){var e=t.page,a=t.limit;this.current=e,this.step=a,this.fetchTableData()},onAddBtnClick:function(){this.createModalVisible=!0},onCreateSuccess:function(){this.current=1,this.fetchTableData()}},mounted:function(){this.fetchTableData()}},C=x,T=(a("58be"),Object(u["a"])(C,n,i,!1,null,"6b660b66",null));e["default"]=T.exports},"47e3":function(t,e,a){},"58be":function(t,e,a){"use strict";a("47e3")},dd1a:function(t,e,a){"use strict";a("fe21")},fe21:function(t,e,a){}}]);