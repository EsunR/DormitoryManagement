(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-40bdffaa"],{1113:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"getup-record"}},[a("h1",{staticClass:"main-title"},[t._v("个人记录")]),t._v(" "),a("div",{staticClass:"top-wrapper"},[a("div",{staticClass:"left-wrapper"},[a("RecordButton",{attrs:{disable:t.btnDisable,"btn-color":"#4527A0"},on:{click:t.handleBtnClick}})],1),t._v(" "),a("div",{staticClass:"right-wrapper"},[a("RecordList",{attrs:{records:t.userBackRecords},on:{change:t.handleSelectedChange}})],1)]),t._v(" "),a("h1",{staticClass:"main-title"},[t._v("折线图表")]),t._v(" "),a("div",{staticClass:"botttom-wrapper"},[a("div",{staticClass:"chart-wrapper"},[a("Chart",{attrs:{"char-data":t.charData}})],1)])])},r=[],i=(a("96cf"),a("3b8d")),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"record-button",class:{"record-button-disable":t.disable},style:{background:t.btnColor},on:{click:t.handleClick}},[a("div",{staticClass:"text"},[t.disable?a("span",[t._v("今日已打卡")]):a("span",[t._v("归宿打卡")])]),t._v(" "),a("div",{staticClass:"date"},[t._v(t._s(t.getDate()))])])},o=[],u={name:"RecordButton",data:function(){return{}},props:{btnColor:{type:String},disable:{type:Boolean}},methods:{handleClick:function(){this.$emit("click")},getDate:function(){return this.$moment().format("YYYY-MM-DD")}}},c=u,l=(a("c776"),a("2877")),d=Object(l["a"])(c,s,o,!1,null,"3fa6c166",null),h=d.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"record-list"},[a("div",{staticClass:"info-wrapper"},[a("div",{staticClass:"top-text"},[t._v("早归概率")]),t._v(" "),a("div",{staticClass:"counter"},[a("countTo",{staticClass:"count",attrs:{startVal:0,endVal:t.percent,decimals:2,duration:1500,suffix:"%"}})],1),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.handleSelectedChange},model:{value:t.showDays,callback:function(e){t.showDays=e},expression:"showDays"}},t._l(t.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),a("el-row",{staticClass:"list-wrapper",attrs:{gutter:20}},t._l(t.records,(function(e){var n;return a("el-col",{key:e.id,attrs:{md:12}},[a("div",{staticClass:"record-item",class:(n={},n[t.getCss(e.time)]=!0,n)},[a("div",{staticClass:"date"},[t._v("\n          "+t._s(e.date)+"\n          "+t._s(e.time)+"\n        ")]),t._v(" "),a("div",{staticClass:"text"},[t._v("\n          "+t._s(t.getText(e.time))+"\n        ")])])])})),1)],1)},p=[],m=(a("c5f6"),a("ac6a"),a("ec1b")),v=a.n(m),b=22,y={name:"RecordList",components:{countTo:v.a},props:{records:{type:Array,default:function(){return[]}}},data:function(){return{options:[{value:7,label:"最近7天"},{value:14,label:"最近14天"},{value:30,label:"最近30天"},{value:50,label:"最近50天"},{value:100,label:"最近100天"}],showDays:7}},computed:{percent:function(){var t=this.records.length,e=0;this.records.forEach((function(t){var a=parseInt(t.time);a<b&&e++}));var a=(e/t*100).toFixed(2);return Number(a)}},methods:{getText:function(t){return t=parseInt(t),isNaN(t)?"无记录":t<b?"早归":"晚归"},getCss:function(t){return t=parseInt(t),isNaN(t)?"no-data":t<b?"early":"late"},handleSelectedChange:function(t){this.$emit("change",t)}}},g=y,w=(a("2b48"),Object(l["a"])(g,f,p,!1,null,"1c15e1b8",null)),V=w.exports,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"chart"},[a("ve-line",{attrs:{data:t.charData,settings:t.chartSettings}})],1)},C=[],F={data:function(){return this.chartSettings={xAxisName:["周期"],yAxisName:["早起概率"],yAxisType:["percent"],area:!0},{}},props:{charData:{type:Object,default:function(){return{columns:[],rows:[]}}}}},D=F,x=Object(l["a"])(D,_,C,!1,null,"70c3ed32",null),A=x.exports,R=a("e5bf"),k={name:"BackRecord",components:{RecordButton:h,RecordList:V,Chart:A},data:function(){return{btnDisable:!0,userBackRecords:[],charData:{},days:7}},computed:{userId:function(){return this.$store.getters.allUserInfo.id},roomId:function(){return this.$store.getters.allUserInfo.roomId}},watch:{userBackRecords:function(t){t[0].time?this.btnDisable=!0:this.btnDisable=!1}},methods:{handleBtnClick:function(){var t=this;if(!this.btnDisable){var e=parseInt(this.$moment().format("HH"));e<19?this.$message("时间还太早，暂不开放打卡"):Object(R["a"])({type:"back"}).then((function(){t.btnDisable=!0,t.fetchUserRecords(t.days).then((function(e){t.userBackRecords=e}))}))}},fetchUserRecords:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(R["f"])({type:"back",userId:this.userId,days:e});case 2:return a=t.sent,t.abrupt("return",a.data.records);case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),handleSelectedChange:function(t){var e=this;this.days=t,this.fetchUserRecords(t).then((function(t){e.userBackRecords=t}))}},mounted:function(){var t=this;this.fetchUserRecords(this.days).then((function(e){t.userBackRecords=e})),Object(R["b"])({type:"back",roomId:this.roomId}).then((function(e){var a=e.data.charData;t.charData=a}))}},I=k,j=(a("c0f2"),Object(l["a"])(I,n,r,!1,null,"d3e4ee80",null));e["default"]=j.exports},"2b48":function(t,e,a){"use strict";var n=a("8d91"),r=a.n(n);r.a},7078:function(t,e,a){},"8d91":function(t,e,a){},a534:function(t,e,a){},c0f2:function(t,e,a){"use strict";var n=a("7078"),r=a.n(n);r.a},c776:function(t,e,a){"use strict";var n=a("a534"),r=a.n(n);r.a},e5bf:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"f",(function(){return i})),a.d(e,"d",(function(){return s})),a.d(e,"b",(function(){return o})),a.d(e,"e",(function(){return u})),a.d(e,"c",(function(){return c}));var n=a("b775");function r(t){var e=t.type;return Object(n["a"])({url:"/record/addRecord",method:"post",data:{type:e}})}function i(t){var e=t.type,a=t.userId,r=t.days,i=t.pure,s=void 0!==i&&i;return Object(n["a"])({url:"/record/getUserRecords",method:"get",params:{type:e,userId:a,days:r,pure:s}})}function s(t){var e=t.type,a=t.roomId,r=t.days,i=t.pure,s=void 0!==i&&i;return Object(n["a"])({url:"/record/getRoomRecords",method:"get",params:{type:e,roomId:a,days:r,pure:s}})}function o(t){var e=t.type,a=t.roomId;return Object(n["a"])({url:"/record/getLineChartData",method:"get",params:{type:e,roomId:a}})}function u(t){return Object(n["a"])({url:"/record/getUserProbability",method:"get",params:{userId:t}})}function c(t,e){var a=e.current,r=void 0===a?void 0:a,i=e.step,s=void 0===i?void 0:i,o=e.buildingId,u=void 0===o?void 0:o,c=e.floorId,l=void 0===c?void 0:c,d=e.roomId,h=void 0===d?void 0:d,f=e.userId,p=void 0===f?void 0:f,m=e.startTime,v=void 0===m?void 0:m,b=e.endTime,y=void 0===b?void 0:b;return Object(n["a"])({url:"/record/getRecordTableData",method:"get",params:{type:t,current:r,step:s,buildingId:u,floorId:l,roomId:h,userId:p,startTime:v,endTime:y}})}},ec1b:function(t,e,a){!function(e,a){t.exports=a()}(0,(function(){return function(t){function e(n){if(a[n])return a[n].exports;var r=a[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var a={};return e.m=t,e.c=a,e.i=function(t){return t},e.d=function(t,a,n){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=2)}([function(t,e,a){var n=a(4)(a(1),a(5),null,null);t.exports=n.exports},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(3);e.default={props:{startVal:{type:Number,required:!1,default:0},endVal:{type:Number,required:!1,default:2017},duration:{type:Number,required:!1,default:3e3},autoplay:{type:Boolean,required:!1,default:!0},decimals:{type:Number,required:!1,default:0,validator:function(t){return t>=0}},decimal:{type:String,required:!1,default:"."},separator:{type:String,required:!1,default:","},prefix:{type:String,required:!1,default:""},suffix:{type:String,required:!1,default:""},useEasing:{type:Boolean,required:!1,default:!0},easingFn:{type:Function,default:function(t,e,a,n){return a*(1-Math.pow(2,-10*t/n))*1024/1023+e}}},data:function(){return{localStartVal:this.startVal,displayValue:this.formatNumber(this.startVal),printVal:null,paused:!1,localDuration:this.duration,startTime:null,timestamp:null,remaining:null,rAF:null}},computed:{countDown:function(){return this.startVal>this.endVal}},watch:{startVal:function(){this.autoplay&&this.start()},endVal:function(){this.autoplay&&this.start()}},mounted:function(){this.autoplay&&this.start(),this.$emit("mountedCallback")},methods:{start:function(){this.localStartVal=this.startVal,this.startTime=null,this.localDuration=this.duration,this.paused=!1,this.rAF=(0,n.requestAnimationFrame)(this.count)},pauseResume:function(){this.paused?(this.resume(),this.paused=!1):(this.pause(),this.paused=!0)},pause:function(){(0,n.cancelAnimationFrame)(this.rAF)},resume:function(){this.startTime=null,this.localDuration=+this.remaining,this.localStartVal=+this.printVal,(0,n.requestAnimationFrame)(this.count)},reset:function(){this.startTime=null,(0,n.cancelAnimationFrame)(this.rAF),this.displayValue=this.formatNumber(this.startVal)},count:function(t){this.startTime||(this.startTime=t),this.timestamp=t;var e=t-this.startTime;this.remaining=this.localDuration-e,this.useEasing?this.countDown?this.printVal=this.localStartVal-this.easingFn(e,0,this.localStartVal-this.endVal,this.localDuration):this.printVal=this.easingFn(e,this.localStartVal,this.endVal-this.localStartVal,this.localDuration):this.countDown?this.printVal=this.localStartVal-(this.localStartVal-this.endVal)*(e/this.localDuration):this.printVal=this.localStartVal+(this.localStartVal-this.startVal)*(e/this.localDuration),this.countDown?this.printVal=this.printVal<this.endVal?this.endVal:this.printVal:this.printVal=this.printVal>this.endVal?this.endVal:this.printVal,this.displayValue=this.formatNumber(this.printVal),e<this.localDuration?this.rAF=(0,n.requestAnimationFrame)(this.count):this.$emit("callback")},isNumber:function(t){return!isNaN(parseFloat(t))},formatNumber:function(t){t=t.toFixed(this.decimals),t+="";var e=t.split("."),a=e[0],n=e.length>1?this.decimal+e[1]:"",r=/(\d+)(\d{3})/;if(this.separator&&!this.isNumber(this.separator))for(;r.test(a);)a=a.replace(r,"$1"+this.separator+"$2");return this.prefix+a+n+this.suffix}},destroyed:function(){(0,n.cancelAnimationFrame)(this.rAF)}}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(0),r=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default=r.default,"undefined"!=typeof window&&window.Vue&&window.Vue.component("count-to",r.default)},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=0,r="webkit moz ms o".split(" "),i=void 0,s=void 0;if("undefined"==typeof window)e.requestAnimationFrame=i=function(){},e.cancelAnimationFrame=s=function(){};else{e.requestAnimationFrame=i=window.requestAnimationFrame,e.cancelAnimationFrame=s=window.cancelAnimationFrame;for(var o=void 0,u=0;u<r.length&&(!i||!s);u++)o=r[u],e.requestAnimationFrame=i=i||window[o+"RequestAnimationFrame"],e.cancelAnimationFrame=s=s||window[o+"CancelAnimationFrame"]||window[o+"CancelRequestAnimationFrame"];i&&s||(e.requestAnimationFrame=i=function(t){var e=(new Date).getTime(),a=Math.max(0,16-(e-n)),r=window.setTimeout((function(){t(e+a)}),a);return n=e+a,r},e.cancelAnimationFrame=s=function(t){window.clearTimeout(t)})}e.requestAnimationFrame=i,e.cancelAnimationFrame=s},function(t,e){t.exports=function(t,e,a,n){var r,i=t=t||{},s=typeof t.default;"object"!==s&&"function"!==s||(r=t,i=t.default);var o="function"==typeof i?i.options:i;if(e&&(o.render=e.render,o.staticRenderFns=e.staticRenderFns),a&&(o._scopeId=a),n){var u=Object.create(o.computed||null);Object.keys(n).forEach((function(t){var e=n[t];u[t]=function(){return e}})),o.computed=u}return{esModule:r,exports:i,options:o}}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",[t._v("\n  "+t._s(t.displayValue)+"\n")])},staticRenderFns:[]}}])}))}}]);