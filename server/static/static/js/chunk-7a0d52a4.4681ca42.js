(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a0d52a4"],{"1c5c":function(e,t,n){},"3fa3":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-wrapper",attrs:{id:"FloorManage"}},[t("h1",{staticClass:"main-title"},[e._v("楼层管理")]),e._v(" "),t("div",{staticClass:"selector-wrapper main-card wrapper"},[t("GroupSelector",{model:{value:e.selectorData,callback:function(t){e.selectorData=t},expression:"selectorData"}}),e._v(" "),t("el-button",{attrs:{type:"primary",round:"",disabled:null===e.selectorData.buildingId},on:{click:e.handleSubmitClick}},[e._v("获取数据")])],1),e._v(" "),t("h1",{staticClass:"main-title"},[e._v("统计信息")]),e._v(" "),t("div",{staticClass:"main-card wrapper"},[null===e.selectedBuildingId?t("span",[e._v("请选择宿舍楼")]):t("statistic-info",{attrs:{buildingId:e.selectedBuildingId}})],1),e._v(" "),t("h1",{staticClass:"main-title"},[e._v("楼层信息")]),e._v(" "),t("div",{staticClass:"list-wrapper"},[0===e.floorsData.length?t("div",{staticClass:"main-card"},[e._v("\n      请选择宿舍楼\n    ")]):e._e(),e._v(" "),e._l(e.floorsData,(function(n){return t("FloorInfoCard",{key:n.id,attrs:{"floor-info":n,"cleaners-data":e.cleanersData}})}))],2)])},r=[],a=n("3392"),o=(n("7f7f"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"FloorInfoCard main-card"},[t("div",{staticClass:"title"},[t("span",[e._v("楼层："+e._s(e.floorInfo.layer)+"层")]),e._v(" "),t("span",[e._v("|")]),e._v(" "),t("span",[e._v("已入住: "+e._s(e.totalStudentCount))]),e._v(" "),t("span",[e._v("剩余床位: "+e._s(e.leftBedCount))])]),e._v(" "),t("div",{staticClass:"info"},[t("div",{staticClass:"left"},e._l(e.floorInfo.rooms,(function(n){return t("router-link",{key:n.id,staticClass:"room-itme",class:{empty:0===n.studentCount,full:n.studentCount>=n.peopleNum},attrs:{tag:"div",to:{name:"roomInfo",query:{roomId:n.id}}}},[e._v("\n        "+e._s(n.number)+"\n      ")])})),1),e._v(" "),t("div",{staticClass:"right"},[t("div",{staticClass:"cleaner",on:{click:function(t){e.dialogVisible=!0}}},[t("div",{staticClass:"title"},[e._v("保洁人员")]),e._v(" "),t("div",{staticClass:"cleaner-name"},[e._v("\n          "+e._s(e.floorInfo.cleaner?e.floorInfo.cleaner.name:"无")+"\n        ")])])])]),e._v(" "),t("el-dialog",{attrs:{title:"分配保洁人员",visible:e.dialogVisible,width:"400px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"dialog-body"},[t("el-select",{attrs:{placeholder:"请选择",clearable:!0},model:{value:e.cleanerId,callback:function(t){e.cleanerId=t},expression:"cleanerId"}},e._l(e.cleanersData,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确 定")])],1)])],1)}),s=[],l=n("be0e"),c={name:"FloorInfoCard",data:function(){return{dialogVisible:!1,cleanerId:null}},props:{floorInfo:{type:Object,default:function(){return{id:null,layer:null,buildingId:null,createdAt:new Date,updatedAt:new Date,deletedAt:null,cleanerId:null,cleaner:null,rooms:[]}}},cleanersData:{type:Array,default:function(){return[]}}},mounted:function(){this.cleanerId=this.floorInfo.cleaner?this.floorInfo.cleaner.id:null},methods:{handleSubmit:function(){var e=this,t=this.floorInfo.cleaner?this.floorInfo.cleaner.id:null;this.cleanerId!==t&&Object(l["a"])(this.floorInfo.id,this.cleanerId).then((function(){e.$message.success("修改保洁人员成功"),e.$parent.fetchFloorData()})),this.dialogVisible=!1}},computed:{totalPeopleNum:function(){return this.floorInfo.rooms.reduce((function(e,t){return e+t.peopleNum}),0)},totalStudentCount:function(){return this.floorInfo.rooms.reduce((function(e,t){return e+t.studentCount}),0)},leftBedCount:function(){return this.totalPeopleNum-this.totalStudentCount}}},u=c,d=(n("94ba"),n("2877")),f=Object(d["a"])(u,o,s,!1,null,"39718f2e",null),_=f.exports,h=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"statistic-info"},[t("div",{staticClass:"summary"},[e._v("总入住人数: "+e._s(e.statisticData.studentCount||0))]),e._v(" "),t("el-row",[t("el-col",{staticClass:"chart-container",attrs:{span:8}},[t("VChart",{attrs:{option:e.sexChartConfig,autoresize:""}})],1),e._v(" "),t("el-col",{staticClass:"chart-container",attrs:{span:8}},[t("VChart",{attrs:{option:e.facultyChartConfig,autoresize:""}})],1),e._v(" "),t("el-col",{staticClass:"chart-container",attrs:{span:8}},[t("VChart",{attrs:{option:e.majorChartConfig,autoresize:""}})],1)],1)],1)},v=[],p=(n("c5f6"),n("70ad")),m=n("5c7f"),g={props:{buildingId:{type:Number,default:void 0}},data:function(){return{loading:!1,statisticData:{}}},components:{VChart:m["a"]},methods:{fetchStatisticData:function(){var e=this;this.buildingId&&(this.loading=!0,Object(p["f"])(this.buildingId).then((function(t){e.statisticData=t.data})).finally((function(){e.loading=!1})))}},watch:{buildingId:{immediate:!0,handler:function(){this.fetchStatisticData()}}},computed:{sexChartConfig:function(){return{title:{text:"性别分布",left:"center"},tooltip:{trigger:"item"},legend:{orient:"horizontal",bottom:0},series:[{type:"pie",labelLine:{show:!1},label:{show:!1},data:[{name:"男生",value:this.statisticData.sex&&this.statisticData.sex.boysCount||0},{name:"女生",value:this.statisticData.sex&&this.statisticData.sex.girlsCount||0}]}]}},facultyChartConfig:function(){return{title:{text:"院系分布",left:"center"},tooltip:{trigger:"item"},legend:{orient:"horizontal",bottom:0},series:[{type:"pie",labelLine:{show:!1},label:{show:!1},data:(this.statisticData.faculty||[]).map((function(e){return{name:e.name,value:e.count}}))}]}},majorChartConfig:function(){return{title:{text:"专业分布",left:"center"},tooltip:{trigger:"item"},legend:{orient:"horizontal",bottom:0},series:[{type:"pie",labelLine:{show:!1},label:{show:!1},data:(this.statisticData.major||[]).map((function(e){return{name:e.name,value:e.count}}))}]}}}},b=g,C=(n("edea"),Object(d["a"])(b,h,v,!1,null,"0e78901d",null)),O=C.exports,w={name:"floorManage",components:{GroupSelector:a["a"],FloorInfoCard:_,StatisticInfo:O},data:function(){return{selectorData:{buildingId:null},selectedBuildingId:null,floorsData:[],cleanersData:[]}},methods:{fetchFloorData:function(){var e=this;Object(l["c"])(this.selectorData.buildingId).then((function(t){e.floorsData=t.data.floors}))},fetchCleanersData:function(){var e=this;Object(p["h"])(this.selectorData.buildingId).then((function(t){e.cleanersData=t.data.cleaners}))},handleSubmitClick:function(){this.selectedBuildingId=this.selectorData.buildingId,this.fetchFloorData(),this.fetchCleanersData()}}},z=w,y=(n("bf57"),Object(d["a"])(z,i,r,!1,null,"756d03f8",null));t["default"]=y.exports},"420d":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o}));var i=n("b775");function r(e){return Object(i["a"])({url:"/room/getRooms",method:"get",params:e})}function a(e){return Object(i["a"])({url:"/room/getRoomInfo",method:"get",params:{roomId:e}})}function o(e){var t=e.roomId,n=void 0===t?null:t,r=e.peopleNum,a=void 0===r?null:r;return Object(i["a"])({url:"/room/updateInfo",method:"post",data:{roomId:n,peopleNum:a}})}},"5c7f":function(e,t,n){"use strict";var i=n("2b0e"),r=i["default"];i["default"].util.warn;var a=n("1be7"),o=n("88b3"),s=null;function l(e){return s||(s=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){return setTimeout(e,16)}).bind(window)),s(e)}var c=null;function u(e){c||(c=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(e){clearTimeout(e)}).bind(window)),c(e)}function d(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function f(e,t){void 0===t&&(t={});var n=document.createElement(e);return Object.keys(t).forEach((function(e){n[e]=t[e]})),n}function _(e,t,n){var i=window.getComputedStyle(e,n||null)||{display:"none"};return i[t]}function h(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};var t=e;while(t!==document){if("none"===_(t,"display"))return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var v='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',p=0,m=null;function g(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=O.bind(e));var n=e.__resize_listeners__;if(!n)if(e.__resize_listeners__=[],window.ResizeObserver){var i=e.offsetWidth,r=e.offsetHeight,a=new ResizeObserver((function(){(e.__resize_observer_triggered__||(e.__resize_observer_triggered__=!0,e.offsetWidth!==i||e.offsetHeight!==r))&&z(e)})),o=h(e),s=o.detached,l=o.rendered;e.__resize_observer_triggered__=!1===s&&!1===l,e.__resize_observer__=a,a.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){z(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(p||(m=d(v)),y(e),e.__resize_rendered__=h(e).rendered,window.MutationObserver){var c=new MutationObserver(e.__resize_mutation_handler__);c.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=c}e.__resize_listeners__.push(t),p++}function b(e,t){var n=e.__resize_listeners__;if(n){if(t&&n.splice(n.indexOf(t),1),!n.length||!t){if(e.detachEvent&&e.removeEventListener)return e.detachEvent("onresize",e.__resize_legacy_resize_handler__),void document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",w),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--p&&m&&m.parentNode.removeChild(m)}}function C(e){var t=e.__resize_last__,n=t.width,i=t.height,r=e.offsetWidth,a=e.offsetHeight;return r!==n||a!==i?{width:r,height:a}:null}function O(){var e=h(this),t=e.rendered,n=e.detached;t!==this.__resize_rendered__&&(!n&&this.__resize_triggers__&&(j(this),this.addEventListener("scroll",w,!0)),this.__resize_rendered__=t,z(this))}function w(){var e=this;j(this),this.__resize_raf__&&u(this.__resize_raf__),this.__resize_raf__=l((function(){var t=C(e);t&&(e.__resize_last__=t,z(e))}))}function z(e){e&&e.__resize_listeners__&&e.__resize_listeners__.forEach((function(t){t.call(e,e)}))}function y(e){var t=_(e,"position");t&&"static"!==t||(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var n=f("div",{className:"resize-triggers"}),i=f("div",{className:"resize-expand-trigger"}),r=f("div"),a=f("div",{className:"resize-contract-trigger"});i.appendChild(r),n.appendChild(i),n.appendChild(a),e.appendChild(n),e.__resize_triggers__={triggers:n,expand:i,expandChild:r,contract:a},j(e),e.addEventListener("scroll",w,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function j(e){var t=e.__resize_triggers__,n=t.expand,i=t.expandChild,r=t.contract,a=r.scrollWidth,o=r.scrollHeight,s=n.offsetWidth,l=n.offsetHeight,c=n.scrollWidth,u=n.scrollHeight;r.scrollLeft=a,r.scrollTop=o,i.style.width=s+1+"px",i.style.height=l+1+"px",n.scrollLeft=c,n.scrollTop=u}n.d(t,"a",(function(){return R}));var I=function(){return I=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},I.apply(this,arguments)},D=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function x(e){return t=Object.create(null),D.forEach((function(n){t[n]=function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[t].apply(e.value,n)}}(n)})),t;var t}var E={autoresize:Boolean},k=/^on[^a-z]/,S=function(e){return k.test(e)};function L(e,t){var n=Object(i["unref"])(e);return n&&"object"==typeof n&&"value"in n?n.value||t:n||t}var A={loading:Boolean,loadingOptions:Object},F=null,N=[],T=[];!function(e,t){if(e&&"undefined"!=typeof document){var n,i=!0===t.prepend?"prepend":"append",r=!0===t.singleTag,a="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(r){var o=N.indexOf(a);-1===o&&(o=N.push(a)-1,T[o]={}),n=T[o]&&T[o][i]?T[o][i]:T[o][i]=s()}else n=s();65279===e.charCodeAt(0)&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function s(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var n=Object.keys(t.attributes),r=0;r<n.length;r++)e.setAttribute(n[r],t.attributes[n[r]]);var o="prepend"===i?"afterbegin":"beforeend";return a.insertAdjacentElement(o,e),e}}("x-vue-echarts{display:block;width:100%;height:100%;min-width:0}\n",{});var M=function(){if(null!=F)return F;if("undefined"==typeof HTMLElement||"undefined"==typeof customElements)return F=!1;try{new Function("tag","class EChartsElement extends HTMLElement {\n  __dispose = null;\n\n  disconnectedCallback() {\n    if (this.__dispose) {\n      this.__dispose();\n      this.__dispose = null;\n    }\n  }\n}\n\nif (customElements.get(tag) == null) {\n  customElements.define(tag, EChartsElement);\n}\n")("x-vue-echarts")}catch(e){return F=!1}return F=!0}();r&&r.config.ignoredElements.push("x-vue-echarts");var R=Object(i["defineComponent"])({name:"echarts",props:I(I({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},E),A),emits:{},inheritAttrs:!1,setup:function(e,t){var n=t.attrs,r=Object(i["shallowRef"])(),s=Object(i["shallowRef"])(),l=Object(i["shallowRef"])(),c=Object(i["inject"])("ecTheme",null),u=Object(i["inject"])("ecInitOptions",null),d=Object(i["inject"])("ecUpdateOptions",null),f=Object(i["toRefs"])(e),_=f.autoresize,h=f.manualUpdate,v=f.loading,p=f.loadingOptions,m=Object(i["computed"])((function(){return l.value||e.option||null})),C=Object(i["computed"])((function(){return e.theme||L(c,{})})),O=Object(i["computed"])((function(){return e.initOptions||L(u,{})})),w=Object(i["computed"])((function(){return e.updateOptions||L(d,{})})),z=Object(i["computed"])((function(){return function(e){var t={};for(var n in e)S(n)||(t[n]=e[n]);return t}(n)})),y=Object(i["getCurrentInstance"])().proxy.$listeners;function j(t){if(r.value){var o=s.value=Object(a["b"])(r.value,C.value,O.value);e.group&&(o.group=e.group);var l=y;l||(l={},Object.keys(n).filter((function(e){return 0===e.indexOf("on")&&e.length>2})).forEach((function(e){var t=e.charAt(2).toLowerCase()+e.slice(3);"Once"===t.substring(t.length-4)&&(t="~".concat(t.substring(0,t.length-4))),l[t]=n[e]}))),Object.keys(l).forEach((function(e){var t=l[e];if(t){var n=e.toLowerCase();"~"===n.charAt(0)&&(n=n.substring(1),t.__once__=!0);var i=o;if(0===n.indexOf("zr:")&&(i=o.getZr(),n=n.substring(3)),t.__once__){delete t.__once__;var r=t;t=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];r.apply(void 0,e),i.off(n,t)}}i.on(n,t)}})),_.value?Object(i["nextTick"])((function(){o&&!o.isDisposed()&&o.resize(),c()})):c()}function c(){var e=t||m.value;e&&o.setOption(e,w.value)}}function D(){s.value&&(s.value.dispose(),s.value=void 0)}var E=null;Object(i["watch"])(h,(function(t){"function"==typeof E&&(E(),E=null),t||(E=Object(i["watch"])((function(){return e.option}),(function(e,t){e&&(s.value?s.value.setOption(e,I({notMerge:e!==t},w.value)):j())}),{deep:!0}))}),{immediate:!0}),Object(i["watch"])([C,O],(function(){D(),j()}),{deep:!0}),Object(i["watchEffect"])((function(){e.group&&s.value&&(s.value.group=e.group)}));var k=x(s);return function(e,t,n){var r=Object(i["inject"])("ecLoadingOptions",{}),a=Object(i["computed"])((function(){return I(I({},L(r,{})),null==n?void 0:n.value)}));Object(i["watchEffect"])((function(){var n=e.value;n&&(t.value?n.showLoading(a.value):n.hideLoading())}))}(s,v,p),function(e,t,n){var r=null;Object(i["watch"])([n,e,t],(function(e,t,n){var i=e[0],a=e[1],s=e[2];i&&a&&s&&(r=Object(o["c"])((function(){a.resize()}),100),g(i,r)),n((function(){r&&i&&b(i,r)}))}))}(s,_,r),Object(i["onMounted"])((function(){j()})),Object(i["onBeforeUnmount"])((function(){M&&r.value?r.value.__dispose=D:D()})),I({chart:s,root:r,setOption:function(t,n){e.manualUpdate&&(l.value=t),s.value?s.value.setOption(t,n||{}):j(t)},nonEventAttrs:z},k)},render:function(){var e=r?{attrs:this.nonEventAttrs}:I({},this.nonEventAttrs);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",Object(i["h"])("x-vue-echarts",e)}})},"93b6":function(e,t,n){},"94ba":function(e,t,n){"use strict";n("1c5c")},be0e:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var i=n("b775");function r(e){return Object(i["a"])({url:"/floor/getFloors",method:"get",params:e})}function a(e){return Object(i["a"])({url:"/floor/getFloorsDetail",method:"get",params:{buildingId:e}})}function o(e,t){return Object(i["a"])({url:"/floor/addCleanerToFloor",method:"post",data:{floorId:e,cleanerId:t}})}},bf57:function(e,t,n){"use strict";n("93b6")},edea:function(e,t,n){"use strict";n("fe17")},fe17:function(e,t,n){}}]);