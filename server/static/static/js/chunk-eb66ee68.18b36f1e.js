(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-eb66ee68"],{"1f9d":function(t,e,n){"use strict";n("3e37")},"3e37":function(t,e,n){},"420d":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return r}));var o=n("b775");function a(t){return Object(o["a"])({url:"/room/getRooms",method:"get",params:t})}function s(t){return Object(o["a"])({url:"/room/getRoomInfo",method:"get",params:{roomId:t}})}function r(t){var e=t.roomId,n=void 0===e?null:e,a=t.peopleNum,s=void 0===a?null:a;return Object(o["a"])({url:"/room/updateInfo",method:"post",data:{roomId:n,peopleNum:s}})}},"4ac9":function(t,e,n){"use strict";var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"room-selector"},[e("el-cascader",{attrs:{"show-all-levels":!0,props:{lazy:!0,lazyLoad:t.lazyLoadFunc,value:"id",label:"label"}},on:{change:t.handleSelectorChange},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1)},a=[],s=(n("7f7f"),n("ac6a"),n("70ad")),r=n("be0e"),i=n("420d"),l={name:"RoomSelector",model:{prop:"value",event:"select"},data:function(){return{selected:[]}},props:["value"],methods:{lazyLoadFunc:function(t,e){var n=t.level;switch(n){case 0:Object(s["g"])().then((function(t){var n=t.data.buildings;n.forEach((function(t){t.label=t.name,t.leaf=!1})),e(n)}));break;case 1:this.buildingId=t.value,Object(r["b"])({buildingId:this.buildingId}).then((function(t){var n=t.data.floors;n.forEach((function(t){t.label=t.layer+"层",t.leaf=!1})),e(n)}));break;case 2:this.floorId=t.value,Object(i["b"])({floorId:this.floorId}).then((function(t){var n=t.data.rooms;n.forEach((function(t){t.label=t.number,t.disabled=t.isFull||0===t.status,t.leaf=!0})),e(n)}));break}},handleSelectorChange:function(t){this.$emit("select",t[t.length-1],t)}}},c=l,u=n("2877"),d=Object(u["a"])(c,o,a,!1,null,"7ac4cb0f",null);e["a"]=d.exports},"4fdf":function(t,e,n){"use strict";n("dc19")},7835:function(t,e,n){},b350:function(t,e,n){"use strict";n.r(e);n("c5f6"),n("7f7f");var o=function(){var t=this,e=this,n=e._self._c;return n("div",{staticClass:"page-wrapper",attrs:{id:"UserInfo"}},[n("h1",{staticClass:"main-title"},[e._v("选择学生")]),e._v(" "),n("div",{staticClass:"wrapper"},[n("el-tabs",{attrs:{type:"border-card"}},[n("el-tab-pane",{attrs:{label:"级联选择"}},[n("GroupSelector",{attrs:{selectorData:e.selectorData}}),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.fetchUserInfo("id",e.selectorData.userId)}}},[e._v("搜索")])],1),e._v(" "),n("el-tab-pane",{attrs:{label:"按学号搜索"}},[n("StudentSearcher",{model:{value:e.searchContent,callback:function(t){e.searchContent=t},expression:"searchContent"}}),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.fetchUserInfo("account",e.searchContent)}}},[e._v("搜索")])],1)],1)],1),e._v(" "),n("h1",{staticClass:"main-title"},[e._v("详细信息")]),e._v(" "),e.studentInfo.id?n("div",{staticClass:"wrapper userInfo-wrapper"},[n("el-row",{staticClass:"top",attrs:{gutter:20}},[n("el-col",{attrs:{md:12}},[n("div",{staticClass:"userInfo-card"},[n("div",{staticClass:"title"},[n("span",[e._v("用户信息")]),e._v(" "),n("el-button",{attrs:{icon:"el-icon-guide"},on:{click:function(t){e.editModalVisible=!0}}},[e._v("\n              调剂宿舍\n            ")])],1),e._v(" "),n("hr"),e._v(" "),n("div",{staticClass:"info-item"},[n("label",[e._v("姓名:")]),e._v(" "),n("span",[e._v(e._s(e.studentInfo.name))])]),e._v(" "),n("div",{staticClass:"info-item"},[n("label",[e._v("学号:")]),e._v(" "),n("span",[e._v(e._s(e.studentInfo.account))])]),e._v(" "),n("div",{staticClass:"info-item"},[n("label",[e._v("手机号:")]),e._v(" "),n("span",[e._v(e._s(e.studentInfo.phone))])]),e._v(" "),n("div",{staticClass:"info-item"},[n("label",[e._v("注册日期:")]),e._v(" "),n("span",[e._v(e._s(e.$moment(e.studentInfo.createdAt).format("YYYY-MM-DD")))])])])]),e._v(" "),n("el-col",{attrs:{md:12}},[n("div",{staticClass:"roomInfo-card"},[n("PanelGroup",{attrs:{userInfo:e.studentInfo}})],1)])],1),e._v(" "),n("div",{staticClass:"bottom main-card",staticStyle:{"margin-top":"20px"}},[n("div",{staticClass:"process-item"},[n("span",[e._v("早起概率：")]),e._v(" "),n("el-progress",{attrs:{"text-inside":!0,"stroke-width":26,percentage:Number((100*e.studentInfo.getupProb).toFixed(2))}})],1),e._v(" "),n("div",{staticClass:"process-item"},[n("span",[e._v("早归概率：")]),e._v(" "),n("el-progress",{attrs:{"text-inside":!0,"stroke-width":26,percentage:Number((100*e.studentInfo.backProb).toFixed(2)),status:"success"}})],1),e._v(" "),n("div",{staticClass:"process-item"},[n("span",[e._v("打扫概率：")]),e._v(" "),n("el-progress",{attrs:{"text-inside":!0,"stroke-width":26,percentage:Number((100*e.studentInfo.cleanProb).toFixed(2)),status:"warning"}})],1)])],1):n("div",{staticClass:"no-data-tips main-card wrapper"},[e._v("请选择用户")]),e._v(" "),n("UserInfoEditModal",{attrs:{visible:e.editModalVisible,userInfo:e.studentInfo},on:{"update:visible":function(t){e.editModalVisible=t},"update-success":function(){return e.fetchUserInfo("id",t.studentInfo.id)}}})],1)},a=[],s=n("3392"),r=function(){var t=this,e=t._self._c;return e("el-autocomplete",{staticClass:"student-search",attrs:{"popper-class":"my-autocomplete","fetch-suggestions":t.querySearch,placeholder:"输入学生姓名或学号"},on:{select:t.handleSelect,input:t.handleInput},scopedSlots:t._u([{key:"default",fn:function(n){var o=n.item;return[e("div",{staticClass:"name"},[t._v(t._s(o.name))]),t._v(" "),e("span",{staticClass:"account"},[t._v(t._s(o.account))])]}}]),model:{value:t.state,callback:function(e){t.state=e},expression:"state"}})},i=[],l=n("c24f"),c={name:"AdminSearcher",model:{prop:"value",event:"input"},data:function(){return{admins:[],state:""}},props:{value:{type:String,default:""}},methods:{querySearch:function(t,e){Object(l["i"])(t).then((function(t){var n=t.data.students;e(n)}))},handleSelect:function(t){this.state=t.account,this.$emit("input",this.state)},handleInput:function(t){this.$emit("input",t)}}},u=c,d=(n("c9da"),n("2877")),f=Object(d["a"])(u,r,i,!1,null,"d1629d0a",null),p=f.exports,m=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"room-panel-group"}},[t.userInfo.id?e("el-row",{attrs:{gutter:30}},t._l(t.panelData,(function(n,o){return e("el-col",{key:o,attrs:{sm:24/(t.panelData.length/2)}},[e("div",{staticClass:"group-item-wrapper"},[e("div",{staticClass:"icon-wrapper"},[e("i",{staticClass:"icon",class:n.icon,style:{color:n.color}})]),t._v(" "),e("div",{staticClass:"text-wrapper"},[e("div",{staticClass:"title"},[t._v(t._s(n.title))]),t._v(" "),e("div",{staticClass:"content"},[t._v(t._s(n.content))])])])])})),1):e("div",{staticClass:"main-card no-data-tips"},[t._v("\n    = 请选择用户 =\n  ")])],1)},v=[],b={name:"RoomPanelGroup",data:function(){return{}},props:{userInfo:{type:Object,required:!0}},computed:{panelData:function(){return[{icon:"el-icon-s-home",color:"#40C9C6",title:"房间号",content:this.userInfo.roomNumber},{icon:"el-icon-location",color:"#36A3F7",title:"所在楼层",content:this.userInfo.floorLayer+"层"},{icon:"el-icon-office-building",color:"#F4516C",title:"宿舍楼",content:this.userInfo.buildingName},{icon:"el-icon-user-solid",color:"#34BFA3",title:"入住日期",content:this.$moment(this.userInfo.checkTime).format("YYYY-MM-DD")}]}}},h=b,_=(n("4fdf"),Object(d["a"])(h,m,v,!1,null,"6442ab78",null)),I=_.exports,C=function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"user-info-edit-modal",attrs:{title:"调剂宿舍",visible:t.visible},on:{"update:visible":function(e){return t.$emit("update:visible",e)}}},[e("el-form",{ref:"form",attrs:{model:t.formData,"label-position":"top"}},[e("el-form-item",{attrs:{prop:"roomId",label:"宿舍"}},[e("room-selector",{model:{value:t.formData.roomId,callback:function(e){t.$set(t.formData,"roomId",e)},expression:"formData.roomId"}})],1)],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){return t.$emit("update:visible",!1)}}},[t._v("\n      取消\n    ")]),t._v(" "),e("el-button",{attrs:{loading:t.updateLoading,type:"primary"},on:{click:t.onConfirmClick}},[t._v("\n      确定\n    ")])],1)],1)},g=[],y=n("4ac9"),k={props:{visible:{type:Boolean,default:!1},userInfo:{type:Object,default:function(){return{}}}},components:{RoomSelector:y["a"]},data:function(){return{formData:{roomId:null},updateLoading:!1}},methods:{onConfirmClick:function(){var t=this;this.$refs.form.validate((function(e){e&&(t.updateLoading=!0,Object(l["j"])({userId:t.userInfo.id,roomId:t.formData.roomId}).then((function(){t.$emit("update:visible",!1),t.$emit("update-success")})).finally((function(){t.updateLoading=!1})))}))}},computed:{currentStudentCount:function(){return this.roomInfo&&this.roomInfo.users instanceof Array?this.roomInfo.users.length:0},currentPeopleCount:function(){return this.roomInfo&&this.roomInfo.peopleNum||0}},watch:{currentPeopleCount:{immediate:!0,handler:function(t){this.formData.peopleNum=t}}}},w=k,j=Object(d["a"])(w,C,g,!1,null,"71cfbbfa",null),D=j.exports,O={name:"UserInfo",components:{GroupSelector:s["a"],StudentSearcher:p,PanelGroup:I,UserInfoEditModal:D},data:function(){return{selectorData:{buildingId:null,floorId:null,roomId:null,userId:null},searchContent:"",studentInfo:{},editModalVisible:!1}},methods:{fetchUserInfo:function(t,e){var n=this;Object(l["d"])({type:t,value:e}).then((function(t){n.studentInfo=t.data}))}},mounted:function(){this.$route.query.userId&&this.fetchUserInfo("id",this.$route.query.userId)}},S=O,x=(n("1f9d"),Object(d["a"])(S,o,a,!1,null,"632cc706",null));e["default"]=x.exports},be0e:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return r}));var o=n("b775");function a(t){return Object(o["a"])({url:"/floor/getFloors",method:"get",params:t})}function s(t){return Object(o["a"])({url:"/floor/getFloorsDetail",method:"get",params:{buildingId:t}})}function r(t,e){return Object(o["a"])({url:"/floor/addCleanerToFloor",method:"post",data:{floorId:t,cleanerId:e}})}},c9da:function(t,e,n){"use strict";n("7835")},dc19:function(t,e,n){}}]);